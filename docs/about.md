# mii

mii — это небольшой php-фреймворк, родившийся как форк kohana (но уже очень далекий от оригинала). 
На данный момент на основе mii работает несколько среднего размера веб-проектов. 
Фреймворк не задумывался как универсальный или публичный. Исходный код выложен на github'е лишь для собственного удобства.

### Философия проекта
Главные ценности: Простота, скорость, минимальный оверхед (минимальный в моем понимании это: 2-5мс). 

Вся история развития mii — это поиск баланса/компромисса между удобством разработки и перечисленными выше качествами. 

Так что, концептуальная чистота, универсальность, правильное использование паттернов проектирования — всё это не про mii :)

Подобный подход позволяет создавать проекты со среднем времени генерации страницы в 20мс (причем 7мс приходится на mysql).

### Архитектура
  
  
### Request flow
  
Запуск web приложения выглядит примерно так:
  
``` (new mii\web\App($config))->run(); ```
  
Перед запуском необходимо подключить Mii.php и автолоадер, задать роуты (Route::set) и константу MII_ENV.
    
App сохраняется в Mii::$app
Создается web\Request
На основе роутов вычисляется необходимый контролер и управление передается методу контролера execute.

Далее, дефолтный web/controller действует так:
$this->access_control();
$this->before();
$this->{action}();
$this->after();

...


### Установка

github то, github сё... бла бла бла... packagist пока не используется, так что клонируем 
и берем нужную версию по тэгу. Можно использовать и мастер-ветку, но осторожно.

В index.php обычно лежит что-то вроде этого:
```php
define('MII_DEBUG', true); // при разработке лучше всегда true, в продакшене очевидно всегда false

define('PUB_PATH',  __DIR__.'/'); // Путь к публичной директории (открытой в nginx'е в мир). 
define('APP_PATH',  __DIR__ . '/../app/'); // Путь к самому нашему приложению


require(__DIR__ . '/../../mii/src/Mii.php'); 

spl_autoload_register(['\Mii', 'autoloader']);

$config = require(APP_PATH.'config.php');

require(APP_PATH.'routes.php');

(new mii\web\App($config))->run();
```

Но при желании можно использовать любой PSR-4 автолоадер (composer'овский, например).

Структура сайта обычно такова:
```
project
 ..app
 ....controllers
 ....models
 ....blocks
 ..mii
 ...src
 ..public
 ....assets
 ....res
 ....index.php
```

Но, на самом деле, жестких зависимостей почти нет. Так что все может быть иначе.


 




 
  